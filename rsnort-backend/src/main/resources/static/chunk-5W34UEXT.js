import{a as je}from"./chunk-XPDOIN52.js";import{a as Ke}from"./chunk-EGQHFC2O.js";import{a as Xe}from"./chunk-RQW5KRBW.js";import{a as Fe,f as Le,g as N,k as x,l as B}from"./chunk-JSTISTR4.js";import{d as Ve,g as Ne,k as Be,l as Ye,m as ze,o as Ge,u as Y}from"./chunk-YUJAXVMM.js";import{a as Ie,b as De}from"./chunk-2MM3FCBE.js";import{d as ie,j as Ae,k as ke,l as Pe,n as Re}from"./chunk-EVYG6S67.js";import{a as We,b as He}from"./chunk-XLB63BX3.js";import{Aa as d,Ab as _e,Cc as Me,Db as ge,Ec as Se,Fb as Z,Ga as he,Gb as J,Gc as Te,Hb as U,Hc as Ee,Jb as ee,Jc as C,Kc as Ue,La as I,Ma as M,Na as K,O as y,Qa as _,Rb as ve,T as w,V as T,Y as m,Ya as p,Yb as V,Zb as ye,_a as P,_b as be,a as v,b as z,ba as f,bb as r,bc as Ce,c as k,ca as u,cb as s,db as R,eb as F,fb as L,ha as pe,hb as b,i as G,jb as g,kb as h,kc as Oe,lc as xe,ma as me,ob as X,pa as E,pb as $,qb as q,rc as te,ta as W,tb as D,tc as we,ub as c,vb as O,wa as H,wb as A,xb as Q,ya as j,yb as fe,zb as ue}from"./chunk-2BTMJZGR.js";var oe=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=M({type:n});static \u0275inj=w({imports:[ke,C,Xe]})}return n})();var $e=new T("mat-select-scroll-strategy",{providedIn:"root",factory:()=>{let n=m(x);return()=>n.scrollStrategies.reposition()}});function qe(n){return()=>n.scrollStrategies.reposition()}var Qe={provide:$e,deps:[x],useFactory:qe};var ae=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=M({type:n});static \u0275inj=w({providers:[Qe],imports:[B,oe,C,N,Y,oe,C]})}return n})();var st=["tooltip"],re=20;var se=new T("mat-tooltip-scroll-strategy",{providedIn:"root",factory:()=>{let n=m(x);return()=>n.scrollStrategies.reposition({scrollThrottle:re})}});function et(n){return()=>n.scrollStrategies.reposition({scrollThrottle:re})}var tt={provide:se,deps:[x],useFactory:et};function it(){return{showDelay:0,hideDelay:0,touchendHideDelay:1500}}var nt=new T("mat-tooltip-default-options",{providedIn:"root",factory:it});var Ze="tooltip-panel",Je=xe({passive:!0}),lt=8,ct=8,dt=24,pt=200,le=(()=>{class n{_elementRef=m(E);_ngZone=m(me);_platform=m(Oe);_ariaDescriber=m(Te);_focusMonitor=m(we);_dir=m(Ee);_injector=m(pe);_viewContainerRef=m(he);_defaultOptions=m(nt,{optional:!0});_overlayRef;_tooltipInstance;_portal;_position="below";_positionAtOrigin=!1;_disabled=!1;_tooltipClass;_viewInitialized=!1;_pointerExitEventsInitialized=!1;_tooltipComponent=ot;_viewportMargin=8;_currentPosition;_cssClassPrefix="mat-mdc";_ariaDescriptionPending;_dirSubscribed=!1;get position(){return this._position}set position(e){e!==this._position&&(this._position=e,this._overlayRef&&(this._updatePosition(this._overlayRef),this._tooltipInstance?.show(0),this._overlayRef.updatePosition()))}get positionAtOrigin(){return this._positionAtOrigin}set positionAtOrigin(e){this._positionAtOrigin=ie(e),this._detach(),this._overlayRef=null}get disabled(){return this._disabled}set disabled(e){let t=ie(e);this._disabled!==t&&(this._disabled=t,t?this.hide(0):this._setupPointerEnterEventsIfNeeded(),this._syncAriaDescription(this.message))}get showDelay(){return this._showDelay}set showDelay(e){this._showDelay=te(e)}_showDelay;get hideDelay(){return this._hideDelay}set hideDelay(e){this._hideDelay=te(e),this._tooltipInstance&&(this._tooltipInstance._mouseLeaveHideDelay=this._hideDelay)}_hideDelay;touchGestures="auto";get message(){return this._message}set message(e){let t=this._message;this._message=e!=null?String(e).trim():"",!this._message&&this._isTooltipVisible()?this.hide(0):(this._setupPointerEnterEventsIfNeeded(),this._updateTooltipMessage()),this._syncAriaDescription(t)}_message="";get tooltipClass(){return this._tooltipClass}set tooltipClass(e){this._tooltipClass=e,this._tooltipInstance&&this._setTooltipClass(this._tooltipClass)}_passiveListeners=[];_touchstartTimeout=null;_destroyed=new G;_isDestroyed=!1;constructor(){let e=this._defaultOptions;e&&(this._showDelay=e.showDelay,this._hideDelay=e.hideDelay,e.position&&(this.position=e.position),e.positionAtOrigin&&(this.positionAtOrigin=e.positionAtOrigin),e.touchGestures&&(this.touchGestures=e.touchGestures),e.tooltipClass&&(this.tooltipClass=e.tooltipClass)),this._viewportMargin=lt}ngAfterViewInit(){this._viewInitialized=!0,this._setupPointerEnterEventsIfNeeded(),this._focusMonitor.monitor(this._elementRef).pipe(y(this._destroyed)).subscribe(e=>{e?e==="keyboard"&&this._ngZone.run(()=>this.show()):this._ngZone.run(()=>this.hide(0))})}ngOnDestroy(){let e=this._elementRef.nativeElement;this._touchstartTimeout&&clearTimeout(this._touchstartTimeout),this._overlayRef&&(this._overlayRef.dispose(),this._tooltipInstance=null),this._passiveListeners.forEach(([t,i])=>{e.removeEventListener(t,i,Je)}),this._passiveListeners.length=0,this._destroyed.next(),this._destroyed.complete(),this._isDestroyed=!0,this._ariaDescriber.removeDescription(e,this.message,"tooltip"),this._focusMonitor.stopMonitoring(e)}show(e=this.showDelay,t){if(this.disabled||!this.message||this._isTooltipVisible()){this._tooltipInstance?._cancelPendingAnimations();return}let i=this._createOverlay(t);this._detach(),this._portal=this._portal||new Fe(this._tooltipComponent,this._viewContainerRef);let o=this._tooltipInstance=i.attach(this._portal).instance;o._triggerElement=this._elementRef.nativeElement,o._mouseLeaveHideDelay=this._hideDelay,o.afterHidden().pipe(y(this._destroyed)).subscribe(()=>this._detach()),this._setTooltipClass(this._tooltipClass),this._updateTooltipMessage(),o.show(e)}hide(e=this.hideDelay){let t=this._tooltipInstance;t&&(t.isVisible()?t.hide(e):(t._cancelPendingAnimations(),this._detach()))}toggle(e){this._isTooltipVisible()?this.hide():this.show(void 0,e)}_isTooltipVisible(){return!!this._tooltipInstance&&this._tooltipInstance.isVisible()}_createOverlay(e){if(this._overlayRef){let l=this._overlayRef.getConfig().positionStrategy;if((!this.positionAtOrigin||!e)&&l._origin instanceof E)return this._overlayRef;this._detach()}let t=this._injector.get(Le).getAncestorScrollContainers(this._elementRef),i=this._injector.get(x),o=i.position().flexibleConnectedTo(this.positionAtOrigin?e||this._elementRef:this._elementRef).withTransformOriginOn(`.${this._cssClassPrefix}-tooltip`).withFlexibleDimensions(!1).withViewportMargin(this._viewportMargin).withScrollableContainers(t);return o.positionChanges.pipe(y(this._destroyed)).subscribe(l=>{this._updateCurrentPositionClass(l.connectionPair),this._tooltipInstance&&l.scrollableViewProperties.isOverlayClipped&&this._tooltipInstance.isVisible()&&this._ngZone.run(()=>this.hide(0))}),this._overlayRef=i.create({direction:this._dir,positionStrategy:o,panelClass:`${this._cssClassPrefix}-${Ze}`,scrollStrategy:this._injector.get(se)()}),this._updatePosition(this._overlayRef),this._overlayRef.detachments().pipe(y(this._destroyed)).subscribe(()=>this._detach()),this._overlayRef.outsidePointerEvents().pipe(y(this._destroyed)).subscribe(()=>this._tooltipInstance?._handleBodyInteraction()),this._overlayRef.keydownEvents().pipe(y(this._destroyed)).subscribe(l=>{this._isTooltipVisible()&&l.keyCode===27&&!Se(l)&&(l.preventDefault(),l.stopPropagation(),this._ngZone.run(()=>this.hide(0)))}),this._defaultOptions?.disableTooltipInteractivity&&this._overlayRef.addPanelClass(`${this._cssClassPrefix}-tooltip-panel-non-interactive`),this._dirSubscribed||(this._dirSubscribed=!0,this._dir.change.pipe(y(this._destroyed)).subscribe(()=>{this._overlayRef&&this._updatePosition(this._overlayRef)})),this._overlayRef}_detach(){this._overlayRef&&this._overlayRef.hasAttached()&&this._overlayRef.detach(),this._tooltipInstance=null}_updatePosition(e){let t=e.getConfig().positionStrategy,i=this._getOrigin(),o=this._getOverlayPosition();t.withPositions([this._addOffset(v(v({},i.main),o.main)),this._addOffset(v(v({},i.fallback),o.fallback))])}_addOffset(e){let t=ct,i=!this._dir||this._dir.value=="ltr";return e.originY==="top"?e.offsetY=-8:e.originY==="bottom"?e.offsetY=t:e.originX==="start"?e.offsetX=i?-8:t:e.originX==="end"&&(e.offsetX=i?t:-8),e}_getOrigin(){let e=!this._dir||this._dir.value=="ltr",t=this.position,i;t=="above"||t=="below"?i={originX:"center",originY:t=="above"?"top":"bottom"}:t=="before"||t=="left"&&e||t=="right"&&!e?i={originX:"start",originY:"center"}:(t=="after"||t=="right"&&e||t=="left"&&!e)&&(i={originX:"end",originY:"center"});let{x:o,y:l}=this._invertPosition(i.originX,i.originY);return{main:i,fallback:{originX:o,originY:l}}}_getOverlayPosition(){let e=!this._dir||this._dir.value=="ltr",t=this.position,i;t=="above"?i={overlayX:"center",overlayY:"bottom"}:t=="below"?i={overlayX:"center",overlayY:"top"}:t=="before"||t=="left"&&e||t=="right"&&!e?i={overlayX:"end",overlayY:"center"}:(t=="after"||t=="right"&&e||t=="left"&&!e)&&(i={overlayX:"start",overlayY:"center"});let{x:o,y:l}=this._invertPosition(i.overlayX,i.overlayY);return{main:i,fallback:{overlayX:o,overlayY:l}}}_updateTooltipMessage(){this._tooltipInstance&&(this._tooltipInstance.message=this.message,this._tooltipInstance._markForCheck(),H(()=>{this._tooltipInstance&&this._overlayRef.updatePosition()},{injector:this._injector}))}_setTooltipClass(e){this._tooltipInstance&&(this._tooltipInstance.tooltipClass=e,this._tooltipInstance._markForCheck())}_invertPosition(e,t){return this.position==="above"||this.position==="below"?t==="top"?t="bottom":t==="bottom"&&(t="top"):e==="end"?e="start":e==="start"&&(e="end"),{x:e,y:t}}_updateCurrentPositionClass(e){let{overlayY:t,originX:i,originY:o}=e,l;if(t==="center"?this._dir&&this._dir.value==="rtl"?l=i==="end"?"left":"right":l=i==="start"?"left":"right":l=t==="bottom"&&o==="top"?"above":"below",l!==this._currentPosition){let S=this._overlayRef;if(S){let de=`${this._cssClassPrefix}-${Ze}-`;S.removePanelClass(de+this._currentPosition),S.addPanelClass(de+l)}this._currentPosition=l}}_setupPointerEnterEventsIfNeeded(){this._disabled||!this.message||!this._viewInitialized||this._passiveListeners.length||(this._platformSupportsMouseEvents()?this._passiveListeners.push(["mouseenter",e=>{this._setupPointerExitEventsIfNeeded();let t;e.x!==void 0&&e.y!==void 0&&(t=e),this.show(void 0,t)}]):this.touchGestures!=="off"&&(this._disableNativeGesturesIfNecessary(),this._passiveListeners.push(["touchstart",e=>{let t=e.targetTouches?.[0],i=t?{x:t.clientX,y:t.clientY}:void 0;this._setupPointerExitEventsIfNeeded(),this._touchstartTimeout&&clearTimeout(this._touchstartTimeout);let o=500;this._touchstartTimeout=setTimeout(()=>{this._touchstartTimeout=null,this.show(void 0,i)},this._defaultOptions?.touchLongPressShowDelay??o)}])),this._addListeners(this._passiveListeners))}_setupPointerExitEventsIfNeeded(){if(this._pointerExitEventsInitialized)return;this._pointerExitEventsInitialized=!0;let e=[];if(this._platformSupportsMouseEvents())e.push(["mouseleave",t=>{let i=t.relatedTarget;(!i||!this._overlayRef?.overlayElement.contains(i))&&this.hide()}],["wheel",t=>this._wheelListener(t)]);else if(this.touchGestures!=="off"){this._disableNativeGesturesIfNecessary();let t=()=>{this._touchstartTimeout&&clearTimeout(this._touchstartTimeout),this.hide(this._defaultOptions?.touchendHideDelay)};e.push(["touchend",t],["touchcancel",t])}this._addListeners(e),this._passiveListeners.push(...e)}_addListeners(e){e.forEach(([t,i])=>{this._elementRef.nativeElement.addEventListener(t,i,Je)})}_platformSupportsMouseEvents(){return!this._platform.IOS&&!this._platform.ANDROID}_wheelListener(e){if(this._isTooltipVisible()){let t=this._injector.get(ve).elementFromPoint(e.clientX,e.clientY),i=this._elementRef.nativeElement;t!==i&&!i.contains(t)&&this.hide()}}_disableNativeGesturesIfNecessary(){let e=this.touchGestures;if(e!=="off"){let t=this._elementRef.nativeElement,i=t.style;(e==="on"||t.nodeName!=="INPUT"&&t.nodeName!=="TEXTAREA")&&(i.userSelect=i.msUserSelect=i.webkitUserSelect=i.MozUserSelect="none"),(e==="on"||!t.draggable)&&(i.webkitUserDrag="none"),i.touchAction="none",i.webkitTapHighlightColor="transparent"}}_syncAriaDescription(e){this._ariaDescriptionPending||(this._ariaDescriptionPending=!0,this._ariaDescriber.removeDescription(this._elementRef.nativeElement,e,"tooltip"),this._isDestroyed||H({write:()=>{this._ariaDescriptionPending=!1,this.message&&!this.disabled&&this._ariaDescriber.describe(this._elementRef.nativeElement,this.message,"tooltip")}},{injector:this._injector}))}static \u0275fac=function(t){return new(t||n)};static \u0275dir=K({type:n,selectors:[["","matTooltip",""]],hostAttrs:[1,"mat-mdc-tooltip-trigger"],hostVars:2,hostBindings:function(t,i){t&2&&P("mat-mdc-tooltip-disabled",i.disabled)},inputs:{position:[0,"matTooltipPosition","position"],positionAtOrigin:[0,"matTooltipPositionAtOrigin","positionAtOrigin"],disabled:[0,"matTooltipDisabled","disabled"],showDelay:[0,"matTooltipShowDelay","showDelay"],hideDelay:[0,"matTooltipHideDelay","hideDelay"],touchGestures:[0,"matTooltipTouchGestures","touchGestures"],message:[0,"matTooltip","message"],tooltipClass:[0,"matTooltipClass","tooltipClass"]},exportAs:["matTooltip"]})}return n})(),ot=(()=>{class n{_changeDetectorRef=m(ee);_elementRef=m(E);_isMultiline=!1;message;tooltipClass;_showTimeoutId;_hideTimeoutId;_triggerElement;_mouseLeaveHideDelay;_animationsDisabled;_tooltip;_closeOnInteraction=!1;_isVisible=!1;_onHide=new G;_showAnimation="mat-mdc-tooltip-show";_hideAnimation="mat-mdc-tooltip-hide";constructor(){let e=m(W,{optional:!0});this._animationsDisabled=e==="NoopAnimations"}show(e){this._hideTimeoutId!=null&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=setTimeout(()=>{this._toggleVisibility(!0),this._showTimeoutId=void 0},e)}hide(e){this._showTimeoutId!=null&&clearTimeout(this._showTimeoutId),this._hideTimeoutId=setTimeout(()=>{this._toggleVisibility(!1),this._hideTimeoutId=void 0},e)}afterHidden(){return this._onHide}isVisible(){return this._isVisible}ngOnDestroy(){this._cancelPendingAnimations(),this._onHide.complete(),this._triggerElement=null}_handleBodyInteraction(){this._closeOnInteraction&&this.hide(0)}_markForCheck(){this._changeDetectorRef.markForCheck()}_handleMouseLeave({relatedTarget:e}){(!e||!this._triggerElement.contains(e))&&(this.isVisible()?this.hide(this._mouseLeaveHideDelay):this._finalizeAnimation(!1))}_onShow(){this._isMultiline=this._isTooltipMultiline(),this._markForCheck()}_isTooltipMultiline(){let e=this._elementRef.nativeElement.getBoundingClientRect();return e.height>dt&&e.width>=pt}_handleAnimationEnd({animationName:e}){(e===this._showAnimation||e===this._hideAnimation)&&this._finalizeAnimation(e===this._showAnimation)}_cancelPendingAnimations(){this._showTimeoutId!=null&&clearTimeout(this._showTimeoutId),this._hideTimeoutId!=null&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=this._hideTimeoutId=void 0}_finalizeAnimation(e){e?this._closeOnInteraction=!0:this.isVisible()||this._onHide.next()}_toggleVisibility(e){let t=this._tooltip.nativeElement,i=this._showAnimation,o=this._hideAnimation;if(t.classList.remove(e?o:i),t.classList.add(e?i:o),this._isVisible!==e&&(this._isVisible=e,this._changeDetectorRef.markForCheck()),e&&!this._animationsDisabled&&typeof getComputedStyle=="function"){let l=getComputedStyle(t);(l.getPropertyValue("animation-duration")==="0s"||l.getPropertyValue("animation-name")==="none")&&(this._animationsDisabled=!0)}e&&this._onShow(),this._animationsDisabled&&(t.classList.add("_mat-animation-noopable"),this._finalizeAnimation(e))}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=I({type:n,selectors:[["mat-tooltip-component"]],viewQuery:function(t,i){if(t&1&&X(st,7),t&2){let o;$(o=q())&&(i._tooltip=o.first)}},hostAttrs:["aria-hidden","true"],hostBindings:function(t,i){t&1&&g("mouseleave",function(l){return i._handleMouseLeave(l)})},decls:4,vars:4,consts:[["tooltip",""],[1,"mdc-tooltip","mat-mdc-tooltip",3,"animationend","ngClass"],[1,"mat-mdc-tooltip-surface","mdc-tooltip__surface"]],template:function(t,i){if(t&1){let o=b();r(0,"div",1,0),g("animationend",function(S){return f(o),u(i._handleAnimationEnd(S))}),r(2,"div",2),c(3),s()()}t&2&&(P("mdc-tooltip--multiline",i._isMultiline),p("ngClass",i.tooltipClass),d(3),O(i.message))},dependencies:[V],styles:[`.mat-mdc-tooltip{position:relative;transform:scale(0);display:inline-flex}.mat-mdc-tooltip::before{content:"";top:0;right:0;bottom:0;left:0;z-index:-1;position:absolute}.mat-mdc-tooltip-panel-below .mat-mdc-tooltip::before{top:-8px}.mat-mdc-tooltip-panel-above .mat-mdc-tooltip::before{bottom:-8px}.mat-mdc-tooltip-panel-right .mat-mdc-tooltip::before{left:-8px}.mat-mdc-tooltip-panel-left .mat-mdc-tooltip::before{right:-8px}.mat-mdc-tooltip._mat-animation-noopable{animation:none;transform:scale(1)}.mat-mdc-tooltip-surface{word-break:normal;overflow-wrap:anywhere;padding:4px 8px;min-width:40px;max-width:200px;min-height:24px;max-height:40vh;box-sizing:border-box;overflow:hidden;text-align:center;will-change:transform,opacity;background-color:var(--mdc-plain-tooltip-container-color, var(--mat-sys-inverse-surface));color:var(--mdc-plain-tooltip-supporting-text-color, var(--mat-sys-inverse-on-surface));border-radius:var(--mdc-plain-tooltip-container-shape, var(--mat-sys-corner-extra-small));font-family:var(--mdc-plain-tooltip-supporting-text-font, var(--mat-sys-body-small-font));font-size:var(--mdc-plain-tooltip-supporting-text-size, var(--mat-sys-body-small-size));font-weight:var(--mdc-plain-tooltip-supporting-text-weight, var(--mat-sys-body-small-weight));line-height:var(--mdc-plain-tooltip-supporting-text-line-height, var(--mat-sys-body-small-line-height));letter-spacing:var(--mdc-plain-tooltip-supporting-text-tracking, var(--mat-sys-body-small-tracking))}.mat-mdc-tooltip-surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}.mdc-tooltip--multiline .mat-mdc-tooltip-surface{text-align:left}[dir=rtl] .mdc-tooltip--multiline .mat-mdc-tooltip-surface{text-align:right}.mat-mdc-tooltip-panel{line-height:normal}.mat-mdc-tooltip-panel.mat-mdc-tooltip-panel-non-interactive{pointer-events:none}@keyframes mat-mdc-tooltip-show{0%{opacity:0;transform:scale(0.8)}100%{opacity:1;transform:scale(1)}}@keyframes mat-mdc-tooltip-hide{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(0.8)}}.mat-mdc-tooltip-show{animation:mat-mdc-tooltip-show 150ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-mdc-tooltip-hide{animation:mat-mdc-tooltip-hide 75ms cubic-bezier(0.4, 0, 1, 1) forwards}
`],encapsulation:2,changeDetection:0})}return n})(),ce=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=M({type:n});static \u0275inj=w({providers:[tt],imports:[Me,B,C,C,N]})}return n})();var ht=()=>["snort","ingest","metrics"];function ft(n,a){if(n&1&&(r(0,"p")(1,"strong"),c(2,"\xDAltima alerta:"),s(),r(3,"code",16),c(4),s()()),n&2){let e=h(2);d(4),Q("",e.lastAlert.msg," \u2014 ",e.lastAlert.timestamp,"")}}function ut(n,a){if(n&1&&(F(0),r(1,"p")(2,"strong"),c(3,"Agente:"),s(),r(4,"code",16),c(5),s()(),r(6,"p")(7,"strong"),c(8,"Estado:"),s(),r(9,"code",17),c(10),s()(),_(11,ft,5,2,"p",18),L()),n&2){let e=h();d(5),O(e.agentSrv.current==null?null:e.agentSrv.current.id),d(4),p("ngClass",e.status.snort_running?"api-up":"api-down"),d(),A(" ",e.status.snort_running?"Activo":"Inactivo"," "),d(),p("ngIf",e.lastAlert)}}function _t(n,a){n&1&&(r(0,"p"),c(1,"No se ha podido obtener el estado del agente."),s())}function gt(n,a){if(n&1&&(r(0,"option",25),c(1),s()),n&2){let e=a.$implicit;p("value",e),d(),O(e)}}function vt(n,a){if(n&1){let e=b();F(0),r(1,"div",19)(2,"label",20),c(3,"Selecciona archivo"),s(),r(4,"select",21),_e("ngModelChange",function(i){f(e);let o=h();return ue(o.selectedFile,i)||(o.selectedFile=i),u(i)}),r(5,"option",22),c(6,"-- elige un archivo --"),s(),_(7,gt,2,2,"option",23),s(),r(8,"button",24),g("click",function(){f(e);let i=h();return u(i.download(i.selectedFile))}),c(9," Descargar "),s()(),L()}if(n&2){let e=h();d(4),fe("ngModel",e.selectedFile),d(3),p("ngForOf",e.archived),d(),p("disabled",!e.selectedFile)}}function yt(n,a){n&1&&(r(0,"p"),c(1,"No hay archivos disponibles."),s())}function bt(n,a){if(n&1){let e=b();r(0,"div",28)(1,"strong"),c(2),s(),r(3,"code",17),c(4),s(),r(5,"button",29),g("click",function(){let i=f(e).$implicit,o=h(2).$implicit,l=h();return u(l.restartAgentService(o.id,o.ip,i))}),c(6," \u{1F501} Reiniciar "),s()()}if(n&2){let e=a.$implicit,t=h(2).$implicit,i=h();d(2),A("",e,":"),d(),p("ngClass",t.statuses[e]==="active"?"api-up":"api-down"),d(),A(" ",t.statuses[e]||"desconocido"," "),d(),p("disabled",i.loadingServices[t.id][e])}}function Ct(n,a){if(n&1&&(r(0,"p")(1,"strong"),c(2,"\xDAltima alerta:"),s(),r(3,"code",16),c(4),s()()),n&2){let e=h(2).$implicit;d(4),Q(" ",e.lastAlert.msg," \u2014 ",e.lastAlert.timestamp," ")}}function Ot(n,a){if(n&1){let e=b();r(0,"div",30)(1,"button",31),g("click",function(){f(e);let i=h(2).$implicit,o=h();return u(o.confirmDelete(i.id))}),r(2,"mat-icon"),c(3,"delete"),s()()()}}function xt(n,a){if(n&1&&(F(0),r(1,"p")(2,"strong"),c(3,"IP:"),s(),r(4,"code",16),c(5),s()(),_(6,bt,7,4,"div",26)(7,Ct,5,2,"p",18)(8,Ot,4,0,"div",27),L()),n&2){let e=h().$implicit;d(5),O(e.ip),d(),p("ngForOf",ge(4,ht)),d(),p("ngIf",e.lastAlert),d(),p("ngIf",e.id!=="central")}}function wt(n,a){n&1&&(r(0,"p")(1,"strong"),c(2,"Estado:"),s(),r(3,"code",32),c(4,"No accesible"),s()())}function Mt(n,a){if(n&1&&(r(0,"mat-card",8)(1,"h2"),c(2),s(),_(3,xt,9,5,"ng-container",9)(4,wt,5,0,"ng-template",null,2,U),s()),n&2){let e=a.$implicit,t=D(5);d(2),A("\u{1F310} Estado del agente ",e.id,""),d(),p("ngIf",e.statuses)("ngIfElse",t)}}var at=class n{agentSrv=m(Ue);api=m(je);uid="";status;lastAlert;archived=[];selectedFile="";loading=!1;sub;intervalId;allAgentsInterval;agentStates=[];loadingServices={};ngOnInit(){return k(this,null,function*(){try{this.uid=yield this.api.getGrafanaDashboardUid()}catch(a){console.error("Error al obtener el UID del dashboard:",a)}this.sub=this.agentSrv.current$.subscribe(a=>{a&&(this.refreshStatus(),this.loadArchived(),this.intervalId&&clearInterval(this.intervalId),this.intervalId=setInterval(()=>this.refreshStatus(),5e3))}),this.refreshAllAgentsStates(),this.allAgentsInterval=setInterval(()=>{this.refreshAllAgentsStates()},5e3)})}ngOnDestroy(){this.sub?.unsubscribe(),this.intervalId&&clearInterval(this.intervalId),this.allAgentsInterval&&clearInterval(this.allAgentsInterval)}refreshStatus(){this.api.getStatus().subscribe({next:a=>this.status=a,error:()=>this.status=void 0}),this.api.getLastAlert().subscribe({next:a=>this.lastAlert=a,error:()=>this.lastAlert=void 0})}loadArchived(){this.api.listArchivedFiles().subscribe(a=>{this.archived=a})}restartSnort(){this.loading=!0,this.api.restartSnort().subscribe({next:()=>{this.refreshStatus(),this.loading=!1},error:()=>this.loading=!1})}download(a){this.api.downloadFile(a).subscribe(e=>{let t=URL.createObjectURL(e),i=document.createElement("a");i.href=t,i.download=a,i.click(),URL.revokeObjectURL(t)})}get ip(){return this.agentSrv.current?.ip??"127.0.0.1"}get tempPanelUrl(){return`http://${this.ip}:3000/d-solo/${this.uid}/snort-ids-ips-dashboard?orgId=1&panelId=29&refresh=1m`}get sysPanelUrl(){return`http://${this.ip}:3000/d-solo/${this.uid}/snort-ids-ips-dashboard?orgId=1&panelId=28&refresh=1m`}refreshAllAgentsStates(){return k(this,null,function*(){let a=this.agentSrv.getAll(),e=yield this.api.getAllAgentsStatuses(a),t=yield Promise.all(e.map(i=>k(this,null,function*(){try{let o=yield this.api.getLastAlertFrom(i.ip).toPromise();return z(v({},i),{lastAlert:o})}catch{return z(v({},i),{lastAlert:void 0})}})));this.agentStates=t,t.forEach(i=>{this.loadingServices[i.id]||(this.loadingServices[i.id]={snort:!1,ingest:!1,metrics:!1})})})}restartAgentService(a,e,t){this.loadingServices[a][t]=!0,this.api.restartService(e,t).subscribe({next:()=>{this.refreshAllAgentsStates(),this.loadingServices[a][t]=!1},error:()=>{this.loadingServices[a][t]=!1}})}confirmDelete(a){let e=a;!confirm(`\u{1F5D1} \xBFEliminar el agente "${e}"?

Esta acci\xF3n eliminar\xE1 su entrada del sistema.`)||!confirm(`\u26A0\uFE0F Confirmaci\xF3n final:

\xBFEst\xE1s COMPLETAMENTE seguro de que deseas eliminar "${e}"?`)||this.agentSrv.remove(a).then(()=>{alert(`\u2705 Agente "${e}" eliminado correctamente.`),this.refreshAllAgentsStates(),this.agentSrv.load().then(()=>{this.agentSrv.setCurrent("central")})}).catch(o=>{let l=o?.error||o;l.includes("central")?alert("\u26A0\uFE0F El m\xF3dulo central no puede eliminarse."):alert(`\u274C Error al eliminar el agente "${e}": ${l}`)})}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=I({type:n,selectors:[["app-status"]],decls:28,vars:12,consts:[["noStatus",""],["noFiles",""],["unreachable",""],[1,"dashboard"],[1,"graphs-column"],[1,"grafana-card"],["width","100%","height","300","frameborder","0",3,"src"],[1,"status-column"],[1,"status-card"],[4,"ngIf","ngIfElse"],["mat-raised-button","","color","primary",3,"click","disabled"],[1,"status-card","archived-panel"],[1,"agents"],[1,"agent-section-title"],[1,"agents-grid"],["class","status-card",4,"ngFor","ngForOf"],[1,"api-value"],[1,"api-value",3,"ngClass"],[4,"ngIf"],[1,"archived-select-container"],["for","archivedSelect",1,"archived-label"],["id","archivedSelect",1,"archived-native-select",3,"ngModelChange","ngModel"],["value","","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],["mat-stroked-button","","color","accent",3,"click","disabled"],[3,"value"],["class","agent-service",4,"ngFor","ngForOf"],["class","delete-button-container",4,"ngIf"],[1,"agent-service"],["mat-mini-button","","color","accent",3,"click","disabled"],[1,"delete-button-container"],["mat-icon-button","","color","warn","matTooltip","Eliminar agente",3,"click"],[1,"api-down"]],template:function(e,t){if(e&1){let i=b();r(0,"div",3)(1,"div",4)(2,"mat-card",5),R(3,"iframe",6),Z(4,"safeUrl"),s(),r(5,"mat-card",5),R(6,"iframe",6),Z(7,"safeUrl"),s()(),r(8,"div",7)(9,"mat-card",8)(10,"h2"),c(11,"\u{1F6E1} Estado de Snort"),s(),_(12,ut,12,4,"ng-container",9)(13,_t,2,0,"ng-template",null,0,U),r(15,"button",10),g("click",function(){return f(i),u(t.restartSnort())}),c(16," \u{1F501} Reiniciar Snort "),s()(),r(17,"mat-card",11)(18,"h2"),c(19,"Logs archivados"),s(),_(20,vt,10,3,"ng-container",9)(21,yt,2,0,"ng-template",null,1,U),s()(),r(23,"div",12)(24,"h2",13),c(25,"\u{1F4E1} Estado general de los agentes"),s(),r(26,"div",14),_(27,Mt,6,3,"mat-card",15),s()()()}if(e&2){let i=D(14),o=D(22);d(3),p("src",J(4,8,t.tempPanelUrl),j),d(3),p("src",J(7,10,t.sysPanelUrl),j),d(6),p("ngIf",t.status)("ngIfElse",i),d(3),p("disabled",t.loading),d(5),p("ngIf",t.archived.length)("ngIfElse",o),d(7),p("ngForOf",t.agentStates)}},dependencies:[Ce,V,ye,be,He,We,Re,Pe,Ae,Ke,Y,ae,Ge,Ye,ze,Be,Ve,Ne,De,Ie,ce,le],styles:[`@font-face{font-family:JetBrains Mono;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v20/tDbY2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKxTN1OVgaY.woff2) format("woff2");unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:JetBrains Mono;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v20/tDbY2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKxTPlOVgaY.woff2) format("woff2");unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:JetBrains Mono;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v20/tDbY2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKxTOVOVgaY.woff2) format("woff2");unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:JetBrains Mono;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v20/tDbY2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKxTNVOVgaY.woff2) format("woff2");unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:JetBrains Mono;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v20/tDbY2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKxTNFOVgaY.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:JetBrains Mono;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v20/tDbY2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKxTOlOV.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}[_ngcontent-%COMP%]:root{--primary-neon: #00e1ff;--dark-surface: #1a1a1a;--dark-elevated: #242424;--text-primary: #ffffff}.dashboard[_ngcontent-%COMP%]{display:grid;grid-template-columns:2fr 1fr;grid-template-rows:auto 1fr;grid-template-areas:"graphs status" "agents agents";gap:2rem;padding:2rem;box-sizing:border-box;min-height:calc(100vh - 64px)}.graphs-column[_ngcontent-%COMP%]{grid-area:graphs;display:flex;flex-direction:column;gap:2rem}.status-column[_ngcontent-%COMP%]{grid-area:status;display:flex;flex-direction:column;gap:2rem}.agents[_ngcontent-%COMP%]{grid-area:agents}.agents-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:2rem}.grafana-card[_ngcontent-%COMP%]{background:#111;color:#fff;padding:.5rem;border-radius:12px;box-shadow:0 0 20px #03dac64d}.status-card[_ngcontent-%COMP%]{background:var(--dark-surface);color:var(--text-primary);padding:1.2rem;border-radius:12px;box-shadow:0 0 12px #64ffda26;font-family:Inter,sans-serif}.status-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 1rem;color:#03dac6;font-weight:600}.api-value[_ngcontent-%COMP%]{font-family:JetBrains Mono,monospace;background:var(--dark-elevated);border-radius:6px;padding:4px 8px}.api-up[_ngcontent-%COMP%]{color:#00e676!important;font-weight:700}.api-down[_ngcontent-%COMP%]{color:#ff5252!important;font-weight:700}.archived-panel[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;justify-content:space-between}.archived-panel[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:1rem;padding-left:1.5em;position:relative}.archived-panel[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]:before{content:"\\1f4c2";position:absolute;left:0;color:var(--primary-neon)}.archived-select-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;align-items:center;justify-content:center;text-align:center}.archived-label[_ngcontent-%COMP%]{color:var(--text-primary);font-weight:500}.archived-native-select[_ngcontent-%COMP%]{width:100%;min-width:200px;height:42px;color:var(--text-primary);background:var(--dark-elevated);border:1px solid var(--primary-neon);border-radius:6px;padding:0 12px;font-weight:500;font-size:14px;appearance:none;background-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%2300e1ff'><path d='M7 10l5 5 5-5z'/></svg>");background-repeat:no-repeat;background-position:right 10px center;cursor:pointer;transition:border .3s,box-shadow .3s,background .3s}.archived-native-select[_ngcontent-%COMP%]:hover{box-shadow:0 0 8px #00e1ff66}.archived-native-select[_ngcontent-%COMP%]:focus{outline:none;border-color:#03dac6;box-shadow:0 0 6px #03dac699}.archived-native-select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{background:var(--dark-surface);color:var(--text-primary)}.archived-panel[_ngcontent-%COMP%]   button.mat-stroked-button[_ngcontent-%COMP%]{align-self:flex-start;height:40px;padding:0 16px;border-radius:6px;background:var(--dark-surface)!important;border:1px solid var(--primary-neon)!important;color:var(--primary-neon)!important;box-shadow:4px 4px 8px #000c,-4px -4px 8px #ffffff0d!important;transition:background .3s,box-shadow .3s,color .3s}.archived-panel[_ngcontent-%COMP%]   button.mat-stroked-button[_ngcontent-%COMP%]:hover:not(.mat-button-disabled){background:var(--primary-neon)!important;color:var(--dark-surface)!important;box-shadow:inset 4px 4px 8px #000c,inset -4px -4px 8px #ffffff0d!important}.archived-panel[_ngcontent-%COMP%]   button.mat-stroked-button[_ngcontent-%COMP%]:before{content:"\\1f4e5";margin-right:6px}.archived-panel[_ngcontent-%COMP%]   button.mat-stroked-button.mat-button-disabled[_ngcontent-%COMP%]{opacity:.6;border-color:#e0e0e04d!important;color:#e0e0e04d!important}.agent-section-title[_ngcontent-%COMP%]{display:none}@media (max-width: 768px){.dashboard[_ngcontent-%COMP%]{grid-template-columns:1fr;grid-template-areas:"graphs" "status" "agents"}}.agent-service[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;margin-bottom:.5rem;flex-wrap:wrap}.agent-service[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{min-width:70px}.agent-service[_ngcontent-%COMP%]   .api-value[_ngcontent-%COMP%]{min-width:90px;text-align:center}.archived-panel[_ngcontent-%COMP%]   button.mat-stroked-button[_ngcontent-%COMP%]{align-self:center}.archived-native-select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{background-color:var(--dark-elevated);color:var(--text-primary)}.archived-native-select[_ngcontent-%COMP%]:focus   option[_ngcontent-%COMP%]{background-color:var(--dark-elevated);color:var(--text-primary)}.archived-native-select[_ngcontent-%COMP%]{background-color:var(--dark-elevated);color:var(--text-primary);border:1px solid var(--primary-neon);border-radius:6px;padding:0 12px;font-weight:500;font-size:14px;appearance:none;background-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%2300e1ff'><path d='M7 10l5 5 5-5z'/></svg>");background-repeat:no-repeat;background-position:right 10px center;transition:background .3s,box-shadow .3s}.delete-agent-wrapper[_ngcontent-%COMP%]{margin-top:1rem;display:flex;align-items:center;gap:.5rem;justify-content:flex-end}.delete-label[_ngcontent-%COMP%]{color:#f66;font-weight:600;font-size:.9rem}.delete-button-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-top:1rem}`]})};export{at as StatusComponent};
