import{a as G}from"./chunk-ODLLWNX5.js";import{a as F,b as N}from"./chunk-QRV5FDXS.js";import{a as B}from"./chunk-YAAELXRA.js";import{a as R}from"./chunk-OB7RAM33.js";import{a as O,b as k}from"./chunk-A7VEZ463.js";import{l as U,n as D}from"./chunk-HVGVPRCV.js";import{a as z,b as V}from"./chunk-OIW6JI6U.js";import{Aa as o,Fb as M,Gb as S,Hb as x,Jc as T,La as w,Qa as u,Y as c,Ya as l,_b as y,ba as f,bb as i,bc as E,c as C,ca as g,cb as a,db as s,eb as v,ec as P,fb as A,hb as I,jb as _,kb as d,tb as h,ub as m,ya as b}from"./chunk-GVHJH67V.js";function j(n,t){if(n&1&&(i(0,"div")(1,"div",8)(2,"mat-card",9),s(3,"grafana-frame",10),a(),i(4,"mat-card",9),s(5,"grafana-frame",10),a(),i(6,"mat-card",9),s(7,"grafana-frame",10),a()(),i(8,"div",11)(9,"mat-card",12),s(10,"iframe",13),M(11,"safeUrl"),a()()()),n&2){let e=d().ngIf,r=d();o(3),l("ip",e.ip)("path","/d-solo/"+r.uid+"/snort-ids-ips-dashboard?orgId=1&panelId=9&refresh=30s"),o(2),l("ip",e.ip)("path","/d-solo/"+r.uid+"/snort-ids-ips-dashboard?orgId=1&panelId=10&refresh=30s"),o(2),l("ip",e.ip)("path","/d-solo/"+r.uid+"/snort-ids-ips-dashboard?orgId=1&panelId=11&refresh=30s"),o(3),l("src",S(11,7,"http://"+e.ip+":3000/d-solo/"+r.uid+"/snort-ids-ips-dashboard?orgId=1&timezone=browser&refresh=1m&panelId=26&__feature.dashboardSceneSolo"),b)}}function H(n,t){n&1&&s(0,"mat-spinner")}function q(n,t){if(n&1){let e=I();v(0),i(1,"div",5)(2,"button",6),_("click",function(){f(e);let p=d();return g(p.downloadCurrentAgentAlerts())}),i(3,"mat-icon"),m(4,"download"),a(),m(5," Descargar alertas de este agente "),a(),i(6,"button",7),_("click",function(){f(e);let p=d();return g(p.downloadAllAlerts())}),i(7,"mat-icon"),m(8,"download"),a(),m(9," Descargar todas las alertas "),a()(),u(10,j,12,9,"div",4)(11,H,1,0,"ng-template",null,1,x),A()}if(n&2){let e=h(12),r=d();o(10),l("ngIf",r.uid)("ngIfElse",e)}}function J(n,t){n&1&&s(0,"mat-spinner")}var $=class n{agentSrv=c(T);api=c(B);http=c(P);uid="";ngOnInit(){return C(this,null,function*(){try{this.uid=yield this.api.getGrafanaDashboardUid()}catch(t){console.error("Error al obtener el UID del dashboard:",t)}})}downloadCurrentAgentAlerts(){let t=this.agentSrv.current;if(!t)return;let e=`http://${t.ip}:9000/download-alerts`;window.open(e,"_blank")}downloadAllAlerts(){let t=this.agentSrv.getAll().find(r=>r.id==="central")?.ip;if(!t){console.error("No se encontr\xF3 el agente central");return}let e=`http://${t}:9000/download-alerts`;window.open(e,"_blank")}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=w({type:n,selectors:[["app-alerts"]],decls:6,vars:2,consts:[["loadingAgents",""],["loadingUid",""],[1,"dashboard-container"],[1,"title"],[4,"ngIf","ngIfElse"],[1,"alert-actions"],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","accent",3,"click"],[1,"grafana-top"],[1,"grafana-panel"],[3,"ip","path"],[1,"grafana-bottom"],[1,"grafana-panel","full"],["width","100%","height","600","frameborder","0","loading","lazy",3,"src"]],template:function(e,r){if(e&1&&(i(0,"div",2)(1,"h1",3),m(2,"\u26A0\uFE0F Panel de Alertas"),a(),u(3,q,13,2,"ng-container",4)(4,J,1,0,"ng-template",null,0,x),a()),e&2){let p=h(5);o(3),l("ngIf",r.agentSrv.current)("ngIfElse",p)}},dependencies:[E,y,V,z,N,F,D,U,k,O,G,R],styles:[".dashboard-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:100vh;background-color:#121212;color:#e0e0e0;font-family:Segoe UI,sans-serif;padding:2rem;box-sizing:border-box}.title[_ngcontent-%COMP%]{text-align:center;font-size:2.5rem;color:#03dac6;margin-bottom:2rem;text-shadow:0 0 10px rgba(3,218,198,.4)}.grafana-top[_ngcontent-%COMP%]{display:grid;gap:1rem;grid-template-columns:repeat(auto-fit,minmax(520px,1fr));margin-bottom:1.5rem}.grafana-bottom[_ngcontent-%COMP%]{flex:1;min-height:600px}.grafana-panel[_ngcontent-%COMP%]{background-color:#1e1e1e;box-shadow:0 0 15px #03dac64d;border-radius:8px;overflow:hidden;display:flex;flex-direction:column}.grafana-panel.full[_ngcontent-%COMP%]{height:100%}grafana-frame[_ngcontent-%COMP%]{display:block;height:100%}grafana-frame[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{width:100%;height:100%;border:none}.alert-actions[_ngcontent-%COMP%]{display:flex;gap:1rem;margin:1rem 0;flex-wrap:wrap}"]})};export{$ as AlertsComponent};
