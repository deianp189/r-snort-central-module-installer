import{Jc as a,S as s,X as i,ec as n}from"./chunk-GVHJH67V.js";var o=class e{constructor(t,r){this.http=t;this.agentSrv=r}get baseUrl(){return`http://${this.agentSrv.current?.ip??"127.0.0.1"}:9000`}getStatus(){return this.http.get(`${this.baseUrl}/status`)}restartSnort(){return this.http.post(`${this.baseUrl}/restart`,{})}listArchivedFiles(){return this.http.get(`${this.baseUrl}/archived-files`)}downloadFile(t){return this.http.get(`${this.baseUrl}/archived-files/${t}`,{responseType:"blob"})}getLastAlert(){return this.http.get(`${this.baseUrl}/alerts/last`)}getAllAgentsStatuses(t){return Promise.all(t.map(r=>this.http.get(`http://${r.ip}:9000/services/status`).toPromise().then(p=>({id:r.id,ip:r.ip,statuses:p})).catch(()=>({id:r.id,ip:r.ip,statuses:null}))))}getLastAlertFrom(t){return this.http.get(`http://${t}:9000/alerts/last`)}restartService(t,r){return this.http.post(`http://${t}:9000/services/${r}/restart`,{})}getGrafanaDashboardUid(){return this.http.get(`${this.baseUrl}/grafana/dashboard-url`).toPromise().then(t=>{if(!t?.url)return"";let r=t.url.match(/\/d\/([^/]+)/);return r?r[1]:""}).catch(()=>"")}static \u0275fac=function(r){return new(r||e)(i(n),i(a))};static \u0275prov=s({token:e,factory:e.\u0275fac,providedIn:"root"})};export{o as a};
